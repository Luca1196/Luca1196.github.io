<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tabla de datos</title>
</head>
<body>
  <h1>Tabla de datos</h1>
  <table id="data-table">
    <!-- Los datos se agregarán aquí -->
  </table>

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
    // Función para cargar la API de Google Sheets y obtener los datos
    function loadSheetsApi() {
      gapi.client.init({
        discoveryDocs: ['https://sheets.googleapis.com/$discovery/rest?version=v4'],
      }).then(function() {
        // Aquí se llama a la función que obtiene los datos del Google Sheets
        getDataFromSheets();
      });
    }

    // Función para obtener los datos desde el Google Sheets
    function getDataFromSheets() {
      gapi.client.sheets.spreadsheets.values.get({
        spreadsheetId: '1BRQRWYm37VUNe3tZlzw_xIjzX_idsDMEvzpKG-ZiZHg',
        range: 'Sheet1', // Obtener todos los datos de la hoja "Sheet1"
      }).then(function(response) {
        var data = response.result.values;
        var table = document.getElementById('data-table');

        // Recorre los datos y crea las filas de la tabla
        data.forEach(function(row) {
          var newRow = table.insertRow();
          row.forEach(function(cellData) {
            var newCell = newRow.insertCell();
            newCell.textContent = cellData;
          });
        });
      });
    }

    // Llama a la función para cargar la API de Google Sheets cuando la página se ha cargado
    window.onload = function() {
      gapi.load('client', loadSheetsApi);
    };
  </script>
  <script src="https://apis.google.com/js/api.js"></script>
</body>
</html>
