<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Próximas actividades sugeridas</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css">
  <style>
    /* Estilos como en la respuesta anterior */
  </style>
</head>
<body>
  <h1>Próximas actividades sugeridas</h1>
  <div class="carousel"></div>

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"></script>
  <script>
    // Función para mostrar el contenido correspondiente al botón seleccionado
    function showContent(contentId) {
      const contents = document.getElementsByClassName('content');
      for (let i = 0; i < contents.length; i++) {
        contents[i].classList.remove('active');
      }
      document.getElementById('content-' + contentId).classList.add('active');
    }

    // Función para cargar la API de Google Sheets y obtener los datos
    function loadSheetsApi() {
      gapi.client.init({
        clientId: '589607610495-keoo8iet6sepmkjahderl8mt9697hl32.apps.googleusercontent.com',
        discoveryDocs: ['https://sheets.googleapis.com/$discovery/rest?version=v4'],
      }).then(function() {
        // Aquí se llama a la función que obtiene los datos del Google Sheets
        getDataFromSheets();
      });
    }

    // Función para obtener los datos desde el Google Sheets
    function getDataFromSheets() {
      gapi.client.sheets.spreadsheets.values.get({
        spreadsheetId: '1BRQRWYm37VUNe3tZlzw_xIjzX_idsDMEvzpKG-ZiZHg',
        range: 'Sheet1!A2:D', // Rango donde están los datos (A partir de la celda A2 hasta la D, ajusta según tus datos)
      }).then(function(response) {
        var data = response.result.values;
        var carouselDiv = document.querySelector('.carousel');

        // Recorre los datos y crea el contenido del carrusel
        data.forEach(function(row) {
          var activityTitle = row[0];
          var activityLink = row[1];
          var activityDate = row[2];
          var activityDescription = row[3];

          var activityElement = document.createElement('div');
          activityElement.innerHTML = '<p>' + activityTitle + '</p>' +
            '<p><a href="' + activityLink + '" target="_blank">' + activityLink + '</a></p>' +
            '<p>Fecha: ' + activityDate + '</p>' +
            '<p>' + activityDescription + '</p>';

          carouselDiv.appendChild(activityElement);
        });

        // Inicializa el carrusel
        $('.carousel').slick({
          dots: true,
          autoplay: true,
          autoplaySpeed: 3000,
          arrows: false,
        });
      });
    }

    // Llama a la función para cargar la API de Google Sheets cuando la página se ha cargado
    window.onload = function() {
      gapi.load('client', loadSheetsApi);
    };
  </script>
  <script src="https://apis.google.com/js/api.js"></script>
</body>
</html>
